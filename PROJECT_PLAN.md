# Рабочий план реализации требований ТЗ

## Технический долг и улучшение кода
- [ ] **Frontend Рефакторинг (FSD):** Привести структуру frontend-части приложения (`app/src/frontend/src/`) в соответствие с принципами Feature-Sliced Design (FSD).
    - [ ] Анализ текущей структуры и определение необходимых слоев (app, pages, widgets, features, entities, shared).
    - [ ] Создание новой структуры директорий согласно FSD.
    - [ ] Перемещение существующих компонентов, страниц, сервисов и утилит в соответствующие слои FSD.
    - [ ] Обновление импортов и связей между модулями.
    - [ ] Тестирование после рефакторинга.
- [x] **Базы данных:**
    - [x] Заменить sequelize.sync() на систему миграций (например, Umzug) для production.
    - [x] Вынести логику одноразовой миграции данных из syncModels в отдельные скрипты миграций.
    - [x] Внедрить использование транзакций БД для атомарных операций.
- [x] **Валидация и безопасность:**
    - [x] Внедрить валидацию входных данных во всех контроллерах (например, Joi или express-validator). (auth, user, client, company, fieldMapping, xlsx (частично) - ✅)
    - [x] Провести аудит безопасности с помощью \`npm audit\` и устранить обнаруженные уязвимости.
- [x] **Логирование:**
    - [x] Сделать уровень логирования настраиваемым через переменные окружения.
    - [x] Стандартизировать формат логирования ошибок в контроллерах.
- [x] **Рефакторинг и структура кода:**
    - [x] Обновить AWS SDK с v2 до v3.
    - [x] Вынести общие вспомогательные функции (например, `sanitizeFileName`) в модуль утилит.
    - [x] Рассмотреть выделение бизнес-логики из контроллеров в сервисный слой.
    - [x] Настроить и проверить генерацию `docs/AI_FUNCTIONS.json` на основе JSDoc комментариев.
- [ ] **Frontend:**
    - [x] Вынести `DebugLogsButton` в `src/frontend/src/components/DebugLogsButton.jsx`. (Перемещено из "Рефакторинг Frontend структуры")
    - [ ] Проверить работоспособность приложения после всех рефакторингов. (Объединено и перемещено)
- [ ] **Frontend: Перенос модулей в slices/shared**
    - [ ] Перенести модуль аутентификации (login, reset-password, AuthProvider) в slices/auth (в процессе)
    - [ ] Перенести модуль Dashboard (layout, home) в slices/dashboard
    - [x] Перенести модуль компаний в slices/companies
    - [x] Перенести модуль клиентов в slices/clients
    - [x] Перенести модуль пользователей клиентов в slices/client-users
    - [x] Перенести модуль маппинга полей в slices/field-mapping
    - [x] Перенести модуль настроек в slices/settings
    - [ ] Перенести общие компоненты, утилиты и константы в shared

## 1. Пользователи и роли
- [x] CRUD для пользователей (создание, редактирование, удаление, получение по id и списком)
- [x] Интерфейс для управления пользователями (frontend)
- [x] Авторизация (login, register)
- [x] Интерфейс для авторизации (frontend)
- [x] Роли пользователей (admin, analyst, moderator)

## 2. Компании и представители
- [x] CRUD для компаний-клиентов
- [x] Интерфейс для управления компаниями (frontend)
- [x] CRUD для представителей компаний
- [x] Интерфейс для управления представителями компаний (frontend)

## 3. Сопоставление полей (маппинг)
- [x] CRUD для маппинга полей (field_mappings)
- [x] Интерфейс для настройки маппинга полей (frontend)

## 4. Импорт и обработка данных о продажах
- [ ] Импорт файлов (XLSX, Google Sheets)
- [ ] Интерфейс для импорта файлов (frontend)
- [ ] История загрузок (import_history)
- [ ] Интерфейс для истории загрузок (frontend)
- [ ] Очистка и стандартизация данных
- [ ] Интерфейс для очистки/стандартизации данных (frontend)

## 5. Словари и алиасы
- [ ] CRUD для словарей корректных значений (dictionaries)
- [ ] Интерфейс для словарей (frontend)
- [ ] CRUD для алиасов (aliases)
- [ ] Интерфейс для алиасов (frontend)

## 6. Блок-листы
- [ ] CRUD для блок-листов (blocklists)
- [ ] Интерфейс для блок-листов (frontend)

## 7. Генерация и выгрузка списков для рассылок
- [ ] Генерация списков по SQL-логике
- [ ] Интерфейс для генерации списков (frontend)
- [ ] Выгрузка списков (CSV, XLSX)
- [ ] Интерфейс для выгрузки списков (frontend)



> По мере реализации задач отмечать их как выполненные ([x]). 